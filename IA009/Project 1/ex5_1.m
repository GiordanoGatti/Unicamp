traco_old = [ 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.7
 1
 0.7
 0.3
 -0.1
 0.05
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.35
 -0.5
 -0.35
 -0.15
 0.05
 -0.025
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.42
 -0.6
 -0.42
 -0.18
 0.06
 -0.03
 0
 0
 0
 0
 0
 0.175
 0.25
 0.175
 0.075
 -0.025
 0.0125
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.21
 0.3
 0.21
 0.09
 -0.03
 0.015
 0
 0
 0
 0
 0
 -0.08749999999999999
 -0.125
 -0.08749999999999999
 -0.0375
 0.0125
 -0.00625
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.105
 -0.15
 -0.105
 -0.045
 0.015
 -0.0075
 0
 0
 0
 0
 0
 0.04375
 0.0625
 0.04375
 0.01875
 -0.00625
 0.003125
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.0525
 0.075
 0.0525
 0.0225
 -0.0075
 0.00375
 0
 0
 0
 0
 0
 0.258125
 0.36875
 0.258125
 0.110625
 -0.036875
 0.0184375
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.02625
 -0.0375
 -0.02625
 -0.01125
 0.00375
 -0.001875
 0
 0
 0
 0
 0
 -0.1290625
 -0.184375
 -0.1290625
 -0.0553125
 0.0184375
 -0.009218750000000001
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.013125
 0.01875
 0.013125
 0.005625
 -0.001875
 0.0009375
 0
 0
 0
 0
 0
 0.06453125
 0.09218750000000001
 0.06453125
 0.02765625
 -0.009218750000000001
 0.004609375000000001
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.0065625
 -0.009375
 -0.0065625
 -0.0028125
 0.0009375
 -0.00046875
 0
 0
 0
 0
 0
 -0.032265625
 -0.0474609375
 -0.03421875
 -0.0151953125
 0.004023437500000001
 -0.002109375000000001
 -9.765625000000001e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.00328125
 0.0046875
 0.00328125
 0.00140625
 -0.00046875
 0.000234375
 0
 0
 0
 0
 0
 0.0175
 0.02568359375
 0.0184765625
 0.008183593749999999
 -0.002207031250000001
 0.00115234375
 4.8828125e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.001640625
 -0.0015234375
 -0.00046875
 0.0001171875
 0.0005859375
 -0.000234375
 5.859375e-005
 0
 0
 0
 0
 -0.008749999999999999
 -0.012841796875
 -0.009238281249999999
 -0.004091796875
 0.001103515625
 -0.0005761718750000001
 -2.44140625e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.00041015625
 -0.0005859375
 -0.00041015625
 -0.00017578125
 5.859375e-005
 -2.9296875e-005
 0
 0
 0
 0
 0.004375
 0.00625
 0.004375
 0.001875
 -0.0006250000000000001
 0.0003125000000000001
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.000205078125
 0.00029296875
 0.000205078125
 8.7890625e-005
 -2.9296875e-005
 1.46484375e-005
 0
 0
 0
 0
 -0.0021875
 -0.003125
 -0.0021875
 -0.0009375
 0.0003125000000000001
 -0.00015625
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.00109375
 0.001015625
 0.0003124999999999998
 -7.812499999999996e-005
 -0.000390625
 0.00015625
 -3.906250000000001e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.0002734375
 0.000390625
 0.0002734375
 0.0001171875
 -3.906250000000001e-005
 1.953125e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.00013671875
 -0.0001953125
 -0.00013671875
 -5.859375e-005
 1.953125e-005
 -9.765625000000002e-006
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0];

traco_contaminado = traco_old';

% Carregar os dados do arquivo 'primarias.mat'
%load('primarias.txt');
traco_primarias_old = [ 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.7
 1
 0.7
 0.3
 -0.1
 0.05
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.42
 -0.6
 -0.42
 -0.18
 0.06
 -0.03
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.28
 0.4
 0.28
 0.12
 -0.04000000000000001
 0.02
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0];

x = [0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.7
 1
 0.7
 0.3
 -0.1
 0.05
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.35
 -0.5
 -0.35
 -0.15
 0.05
 -0.025
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.42
 -0.6
 -0.42
 -0.18
 0.06
 -0.03
 0
 0
 0
 0
 0
 0.175
 0.25
 0.175
 0.075
 -0.025
 0.0125
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.21
 0.3
 0.21
 0.09
 -0.03
 0.015
 0
 0
 0
 0
 0
 -0.08749999999999999
 -0.125
 -0.08749999999999999
 -0.0375
 0.0125
 -0.00625
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.105
 -0.15
 -0.105
 -0.045
 0.015
 -0.0075
 0
 0
 0
 0
 0
 0.04375
 0.0625
 0.04375
 0.01875
 -0.00625
 0.003125
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.0525
 0.075
 0.0525
 0.0225
 -0.0075
 0.00375
 0
 0
 0
 0
 0
 0.258125
 0.36875
 0.258125
 0.110625
 -0.036875
 0.0184375
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.02625
 -0.0375
 -0.02625
 -0.01125
 0.00375
 -0.001875
 0
 0
 0
 0
 0
 -0.1290625
 -0.184375
 -0.1290625
 -0.0553125
 0.0184375
 -0.009218750000000001
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.013125
 0.01875
 0.013125
 0.005625
 -0.001875
 0.0009375
 0
 0
 0
 0
 0
 0.06453125
 0.09218750000000001
 0.06453125
 0.02765625
 -0.009218750000000001
 0.004609375000000001
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.0065625
 -0.009375
 -0.0065625
 -0.0028125
 0.0009375
 -0.00046875
 0
 0
 0
 0
 0
 -0.032265625
 -0.0474609375
 -0.03421875
 -0.0151953125
 0.004023437500000001
 -0.002109375000000001
 -9.765625000000001e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.00328125
 0.0046875
 0.00328125
 0.00140625
 -0.00046875
 0.000234375
 0
 0
 0
 0
 0
 0.0175
 0.02568359375
 0.0184765625
 0.008183593749999999
 -0.002207031250000001
 0.00115234375
 4.8828125e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.001640625
 -0.0015234375
 -0.00046875
 0.0001171875
 0.0005859375
 -0.000234375
 5.859375e-005
 0
 0
 0
 0
 -0.008749999999999999
 -0.012841796875
 -0.009238281249999999
 -0.004091796875
 0.001103515625
 -0.0005761718750000001
 -2.44140625e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.00041015625
 -0.0005859375
 -0.00041015625
 -0.00017578125
 5.859375e-005
 -2.9296875e-005
 0
 0
 0
 0
 0.004375
 0.00625
 0.004375
 0.001875
 -0.0006250000000000001
 0.0003125000000000001
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.000205078125
 0.00029296875
 0.000205078125
 8.7890625e-005
 -2.9296875e-005
 1.46484375e-005
 0
 0
 0
 0
 -0.0021875
 -0.003125
 -0.0021875
 -0.0009375
 0.0003125000000000001
 -0.00015625
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.00109375
 0.001015625
 0.0003124999999999998
 -7.812499999999996e-005
 -0.000390625
 0.00015625
 -3.906250000000001e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0.0002734375
 0.000390625
 0.0002734375
 0.0001171875
 -3.906250000000001e-005
 1.953125e-005
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 -0.00013671875
 -0.0001953125
 -0.00013671875
 -5.859375e-005
 1.953125e-005
 -9.765625000000002e-006
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
];


tam = 100;
rx = [];
size = 28;
for i = 0:1:tam-2;
    rx_ = (x(1:end-size-i)'*x(size+1+i:end))/(length(x)-i);
    rx = [rx rx_];
end



%Rx = [rx(1) rx(2) rx(3) rx(4) rx(5) rx(6) rx(7) rx(8) rx(9) rx(10) rx(11) rx(12)
M = tam - 1;
Rx = zeros(M);
%L = 1;
m = 0;
for i = 1:M
    m = m+1;
%    l = 0;
    p = 1;
    for j = m:M
        Rx(i,j) = rx(p);
        Rx(j,i) = Rx(i,j);
        p = p+1;
    end
end

w = rx * inv(Rx)

a = [1 w];

y = conv(x,a)

stem(y(1:200),'.');
